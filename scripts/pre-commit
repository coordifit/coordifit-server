#!/bin/sh
# === Pre-commit Hook (Spotless-only for originally staged files) ===

# 1. í˜„ì¬ ìŠ¤í…Œì´ì§•ëœ íŒŒì¼ ëª©ë¡ì„ ë°±ì—…
STAGED=$(git diff --cached --name-only)

echo "[HOOK] ğŸ”§ Running Spotless Apply..."
./gradlew spotlessApply --quiet || exit 1

# 2. ì›ë˜ ìŠ¤í…Œì´ì§•ë¼ ìˆë˜ íŒŒì¼ë“¤ë§Œ ë‹¤ì‹œ ìŠ¤í…Œì´ì§•
echo "[HOOK] ğŸ”„ Re-staging only originally staged files..."
echo "$STAGED" | xargs git add

echo "[HOOK] ğŸ” Running Spotless Check..."
./gradlew spotlessCheck --quiet || exit 1

echo "[HOOK] âœ… All checks passed. Commit continues."
